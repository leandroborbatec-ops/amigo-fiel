<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Amigo Fiel SOS</title>
    
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0084ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="amigofiel.png">

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { background-color: #f0f2f5; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        .header { background-color: #0084ff; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .btn-ajuda-agora { background-color: #ff0000; color: white; border: none; padding: 8px 12px; border-radius: 5px; font-weight: bold; font-size: 13px; text-decoration: none; text-align: center; line-height: 1.2; }
        .cvv-legenda { font-size: 9px; margin-top: 3px; color: #fff; opacity: 0.9; text-align: right; }
        
        #chat-container { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .mensagem { max-width: 85%; padding: 12px 16px; border-radius: 20px; font-size: 15px; line-height: 1.4; position: relative; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .bot { background-color: white; align-self: flex-start; border-bottom-left-radius: 2px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); color: #333; }
        .user { background-color: #0084ff; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

        .sentimentos-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px; justify-content: center; }
        .btn-emoji { background: #f8f9fa; border: 1px solid #dee2e6; padding: 8px 12px; border-radius: 15px; cursor: pointer; font-size: 14px; }

        .opcoes-container { display: flex; flex-direction: column; gap: 10px; padding: 0 20px; margin-bottom: 10px; }
        .btn-opcao { background-color: #0084ff; color: white; border: none; padding: 12px; border-radius: 25px; font-weight: 500; cursor: pointer; width: 100%; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }

        /* Estilo do Cart√£o de Contato do L√≠der conforme solicitado */
        .cartao-contato { background: #fff; border: 1px solid #eee; border-radius: 10px; padding: 12px; margin-top: 10px; width: 100%; display: flex; flex-direction: column; gap: 5px; }
        .contato-info { font-size: 14px; color: #555; display: flex; align-items: center; gap: 8px; }
        .btn-whats { background-color: #25D366; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; margin-top: 10px; }

        .footer-container { background: white; padding: 10px; border-top: 1px solid #eee; }
        .input-area { display: flex; gap: 10px; align-items: center; max-width: 600px; margin: 0 auto; }
        input#userInput { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 25px; outline: none; font-size: 16px; }
        .btn-enviar { background-color: #0084ff; border: none; width: 45px; height: 45px; border-radius: 50%; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        
        .disclaimer { font-size: 10px; color: #888; text-align: center; padding: 5px 10px; }
        .btn-doar { background-color: #28a745; color: white; border: none; padding: 8px 20px; border-radius: 20px; font-size: 13px; font-weight: bold; margin: 5px auto; display: block; cursor: pointer; text-decoration: none; text-align: center; width: fit-content; }
    </style>
</head>
<body>

    <div class="header">
        <div><h2 style="font-size: 18px;">SOS - Amigo Fiel</h2></div>
        <div style="display: flex; flex-direction: column; align-items: flex-end;">
            <a href="tel:188" class="btn-ajuda-agora">AJUDA AGORA<br><span style="font-size: 10px; font-weight: normal;">Ligar CVV 188</span></a>
            <span class="cvv-legenda">Centro de Valoriza√ß√£o da Vida</span>
        </div>
    </div>

    <div id="chat-container">
        <div class="mensagem bot">
            Que alegria ter sua presen√ßa aqui. Eu sou o Amigo Fiel e estou dispon√≠vel para te ouvir. 
            <br><br><b>Como est√° seu cora√ß√£o hoje?</b>
            <div class="sentimentos-container">
                <button class="btn-emoji" onclick="enviarSentimento('üòä', 'Gratid√£o')">üòä Gratid√£o</button>
                <button class="btn-emoji" onclick="enviarSentimento('üòê', 'Normal')">üòê Normal</button>
                <button class="btn-emoji" onclick="enviarSentimento('üòî', 'Tristeza')">üòî Tristeza</button>
                <button class="btn-emoji" onclick="enviarSentimento('üò∞', 'Ansiedade')">üò∞ Ansiedade</button>
                <button class="btn-emoji" onclick="enviarSentimento('üò°', 'Raiva')">üò° Raiva</button>
            </div>
        </div>
    </div>

    <div class="opcoes-container">
        <button class="btn-opcao" onclick="mostrarLider()">Quero conhecer uma c√©lula / Falar com volunt√°rio</button>
        <button class="btn-opcao" onclick="darVersiculo()">Preciso de um conselho b√≠blico agora (Vers√≠culo)</button>
    </div>

    <div class="footer-container">
        <div class="input-area">
            <input type="text" id="userInput" placeholder="Escreva aqui..." onkeypress="if(event.key==='Enter') enviarMensagem()">
            <button class="btn-enviar" onclick="enviarMensagem()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
            </button>
        </div>
        <p class="disclaimer">Apoio b√≠blico Batista. Este servi√ßo n√£o substitui psic√≥logos ou m√©dicos.</p>
        <a href="SEU_PIX_AQUI" target="_blank" class="btn-doar">‚ù§ Manter este projeto vivo</a>
    </div>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('userInput');

        const versiculos = [
            "Filipenses 4:13: Tudo posso naquele que me fortalece.",
            "Salmos 23:1: O Senhor √© o meu pastor; nada me faltar√°.",
            "Mateus 11:28: Vinde a mim, todos os que estais cansados.",
            "Salmos 46:1: Deus √© o nosso ref√∫gio e fortaleza.",
            "1 Pedro 5:7: Lan√ßando sobre ele toda a vossa ansiedade.",
            "Salmos 37:5: Entrega o teu caminho ao Senhor; confia nele.",
            "Romanos 8:28: Todas as coisas cooperam para o bem.",
            "Isa√≠as 41:10: N√£o temas, porque eu sou contigo.",
            "Jo√£o 14:27: Deixo-vos a paz, a minha paz vos dou.",
            "Josu√© 1:9: Seja forte e corajoso! O Senhor estar√° contigo."
            // Complete com os outros 20 que voc√™ preferir
        ];

        function adicionarMensagem(texto, tipo, isHTML = false) {
            const div = document.createElement('div');
            div.className = `mensagem ${tipo}`;
            if (isHTML) div.innerHTML = texto; else div.innerText = texto;
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function mostrarLider() {
            adicionarMensagem("Quero falar com um volunt√°rio.", "user");
            // INSIRA OS DADOS DO L√çDER ABAIXO
            const html = `
                Fale agora com nosso l√≠der respons√°vel para acolhimento e orienta√ß√µes:
                <div class="cartao-contato">
                    <div class="contato-info">üë§ <b>Nome:</b> Leandro Batista</div>
                    <div class="contato-info">üìû <b>Telefone:</b> (XX) XXXXX-XXXX</div>
                    <div class="contato-info">üìß <b>E-mail:</b> contato@igreja.com</div>
                    <a href="https://wa.me/55XXXXXXXXXXX" target="_blank" class="btn-whats">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="20"> 
                        Chamar agora no WhatsApp
                    </a>
                </div>
            `;
            setTimeout(() => adicionarMensagem(html, "bot", true), 600);
        }

        function darVersiculo() {
            const v = versiculos[Math.floor(Math.random() * versiculos.length)];
            adicionarMensagem("Preciso de um conselho b√≠blico.", "user");
            setTimeout(() => adicionarMensagem(`Pessoa querida, medite nesta palavra: <br><br><b>${v}</b>`, "bot", true), 600);
        }

        function enviarSentimento(emoji, texto) {
            adicionarMensagem(`${emoji} Sinto muita ${texto.toLowerCase()} hoje.`, 'user');
            processarIA(texto);
        }

        function enviarMensagem() {
            const texto = userInput.value.trim();
            if (!texto) return;
            adicionarMensagem(texto, 'user');
            userInput.value = "";
            processarIA(texto);
        }

        async function processarIA(msg) {
            try {
                const res = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ mensagem: msg })
                });
                const data = await res.json();
                adicionarMensagem(data.resposta, 'bot');
            } catch (e) {
                adicionarMensagem("Estou aqui ouvindo voc√™. Tente enviar novamente.", "bot");
            }
        }
    </script>
</body>
</html>
