<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SOS - Amigo Fiel</title>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        
        /* Cabe√ßalho com CVV e Nome do App */
        .header { background-color: #0084ff; color: white; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .header-title { font-size: 18px; font-weight: bold; }
        .btn-ajuda-container { display: flex; flex-direction: column; align-items: flex-end; }
        .btn-ajuda { background-color: #ff0000; color: white; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 11px; text-align: center; line-height: 1.2; }
        .cvv-text { font-size: 9px; color: white; margin-top: 2px; text-align: right; }
        
        /* √Årea do Chat */
        #chat-container { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .message { max-width: 85%; padding: 12px; border-radius: 15px; line-height: 1.4; font-size: 16px; position: relative; }
        .bot { background-color: white; align-self: flex-start; border-bottom-left-radius: 2px; color: #333; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .user { background-color: #0084ff; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }
        
        /* Estilo dos Bot√µes de Op√ß√£o (Azul e Arredondado) */
        .opcoes-container { padding: 10px 20px; display: flex; flex-direction: column; gap: 8px; }
        .btn-opcao { background-color: #0084ff; color: white; border: none; padding: 15px; border-radius: 30px; cursor: pointer; text-align: center; font-size: 14px; font-weight: 500; box-shadow: 0 2px 4px rgba(0,0,0,0.1); width: 100%; }
        
        /* Card da C√©lula */
        .card-celula { background: #e7f3ff; border: 1px solid #0084ff; border-radius: 10px; padding: 15px; margin-top: 10px; color: #333; font-size: 14px; }
        .card-celula strong { color: #0084ff; display: block; margin-bottom: 5px; font-size: 16px; }
        .btn-whatsapp { display: inline-block; background-color: #25d366; color: white !important; text-decoration: none; padding: 10px 15px; border-radius: 20px; font-weight: bold; margin-top: 10px; text-align: center; }

        /* √Årea de Input */
        .input-area { padding: 15px; background: white; display: flex; gap: 10px; border-top: 1px solid #ddd; align-items: center; }
        input { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 25px; outline: none; }
        .btn-send { background: #0084ff; color: white; border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        
        /* Rodap√© √âtico e Doa√ß√£o */
        .footer-info { font-size: 10px; color: #888; text-align: center; padding: 15px; background: white; }
        .btn-doar { background: #28a745; color: white; border: none; padding: 8px 20px; border-radius: 20px; font-size: 12px; margin-top: 8px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

    <div class="header">
        <div class="header-title">SOS - Amigo Fiel</div>
        <div class="btn-ajuda-container">
            <button class="btn-ajuda" onclick="window.location.href='tel:188'">AJUDA AGORA<br>Ligar CVV 188</button>
            <div class="cvv-text">Centro de Valoriza√ß√£o da Vida</div>
        </div>
    </div>

    <div id="chat-container">
        <div class="message bot">Ol√°! Eu sou o Amigo Fiel. Estou aqui para te ouvir sem julgamentos. Como voc√™ est√° se sentindo hoje? Pode desabafar...</div>
    </div>

    <div class="opcoes-container">
        <button class="btn-opcao" onclick="enviarOpcao('Gostaria de conhecer uma c√©lula?')">Gostaria de conhecer uma c√©lula?</button>
        <button class="btn-opcao" onclick="enviarOpcao('Preciso de um conselho b√≠blico agora')">Preciso de um conselho b√≠blico agora</button>
    </div>

    <div class="input-area">
        <input type="text" id="user-input" placeholder="Escreva aqui...">
        <button class="btn-send" onclick="enviarMensagem()">‚û§</button>
    </div>

    <div class="footer-info">
        Apoio b√≠blico Batista. Este servi√ßo n√£o substitui psic√≥logos ou m√©dicos.<br>
        <button class="btn-doar" onclick="alert('Obrigado! Em breve voc√™ poder√° contribuir.')">‚ù§ Manter este projeto vivo</button>
    </div>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');

        const caixaDePromessas = [
            "Lan√ßando sobre ele toda a vossa ansiedade, porque ele tem cuidado de v√≥s. (1 Pedro 5:7)",
            "O Senhor √© o meu pastor, nada me faltar√°. (Salmos 23:1)",
            "N√£o temas, porque eu sou contigo. (Isa√≠as 41:10)",
            "Tudo posso naquele que me fortalece. (Filipenses 4:13)",
            "O Senhor est√° perto dos que t√™m o cora√ß√£o quebrantado. (Salmos 34:18)",
            "O choro pode durar uma noite, mas a alegria vem pela manh√£. (Salmos 30:5)",
            "Se Deus √© por n√≥s, quem ser√° contra n√≥s? (Romanos 8:31)",
            "A minha gra√ßa te basta, porque o meu poder se aperfei√ßoa na fraqueza. (2 Cor√≠ntios 12:9)",
            "Entrega o teu caminho ao Senhor; confia nele, e ele tudo far√°. (Salmos 37:5)",
            "Espera no Senhor, anima-te, e ele fortalecer√° o teu cora√ß√£o. (Salmos 27:14)",
            "Pois eu bem sei os planos que tenho para voc√™s... dar esperan√ßa e um futuro. (Jeremias 29:11)",
            "O Senhor √© bom, um ref√∫gio em tempos de ang√∫stia. (Naum 1:7)",
            "Aquietai-vos, e sabei que eu sou Deus. (Salmos 46:10)",
            "Deus √© nosso ref√∫gio e fortaleza, socorro bem presente na ang√∫stia. (Salmos 46:1)",
            "O Senhor te guardar√° de todo o mal; ele guardar√° a tua alma. (Salmos 121:7)",
            "A paz de Deus, que excede todo entendimento, guardar√° seu cora√ß√£o. (Filipenses 4:7)",
            "O nome do Senhor √© uma torre forte; os justos correm para ela e est√£o seguros. (Prov√©rbios 18:10)",
            "Deixo-vos a paz, a minha paz vos dou. (Jo√£o 14:27)",
            "S√™ forte e corajoso; n√£o temas, nem te espantes. (Josu√© 1:9)",
            "Confia no Senhor de todo o teu cora√ß√£o. (Prov√©rbios 3:5)",
            "Mil cair√£o ao teu lado, mas n√£o chegar√° a ti. (Salmos 91:7)",
            "N√£o andeis ansiosos por coisa alguma. (Filipenses 4:6)",
            "Eis que estou convosco todos os dias. (Mateus 28:20)",
            "O Senhor √© a minha luz e a minha salva√ß√£o; de quem terei medo? (Salmos 27:1)",
            "Alegrai-vos na esperan√ßa, sede pacientes na tribula√ß√£o. (Romanos 12:12)",
            "Mas os que esperam no Senhor renovar√£o as suas for√ßas. (Isa√≠as 40:31)",
            "Pe√ßam, e lhes ser√° dado; busquem, e encontrar√£o. (Mateus 7:7)",
            "Ningu√©m despreze a tua mocidade; mas s√™ o exemplo dos fi√©is. (1 Tim√≥teo 4:12)",
            "Escondi a tua palavra no meu cora√ß√£o. (Salmos 119:11)",
            "Deus √© fiel; ele n√£o deixar√° que voc√™s sejam tentados al√©m do que suportam. (1 Cor√≠ntios 10:13)"
        ];

        function adicionarMensagem(texto, remetente, htmlExtra = "") {
            const div = document.createElement('div');
            div.className = `message ${remetente}`;
            div.innerHTML = texto + htmlExtra;
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function enviarMensagem() {
            const texto = userInput.value.trim();
            if (!texto) return;
            userInput.value = '';
            adicionarMensagem(texto, 'user');

            try {
                // Linha que comunica com a sua IA
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ mensagem: texto })
                });
                const data = await response.json();
                adicionarMensagem(data.resposta, 'bot');
            } catch (e) {
                // Caso o servidor de IA esteja desligado ou falhe
                adicionarMensagem("Entendo... pode falar mais sobre isso, estou ouvindo voc√™.", 'bot');
            }
        }

        function enviarOpcao(texto) {
            adicionarMensagem(texto, 'user');
            setTimeout(() => {
                if(texto.includes('conselho')) {
                    const sorteado = caixaDePromessas[Math.floor(Math.random() * caixaDePromessas.length)];
                    adicionarMensagem(`Receba essa linda mensagem para alegrar o seu dia: \n\n"${sorteado}"`, 'bot');
                } else if(texto.includes('c√©lula')) {
                    const card = `
                        <div class="card-celula">
                            <strong>L√≠der Respons√°vel: Mission√°rio Jo√£o</strong>
                            üì± WhatsApp: (00) 00000-0000<br>
                            üìß E-mail: contato@igreja.com.br
                            <p><small>Entre em contato ou envie um e-mail, em breve retornaremos para voc√™!</small></p>
                            <a href="https://wa.me/5500000000000?text=Ol√°!%20Gostaria%20de%20conhecer%20uma%20c√©lula." class="btn-whatsapp">‚û§ Falar pelo WhatsApp</a>
                        </div>
                    `;
                    adicionarMensagem("Que demais! As c√©lulas s√£o o melhor lugar para caminhar em comunh√£o. Aqui est√° o contato do nosso l√≠der:", 'bot', card);
                }
            }, 800);
        }

        userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') enviarMensagem(); });
    </script>
</body>
</html>
